<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"
      xmlns:f="http://typo3.org/ns/fluid/ViewHelpers"
      xmlns:fo="http://typo3.org/ns/Fab/Formule/ViewHelpers">

<f:layout name="Default"/>

<f:section name="main">

	<fo:loadAssets/>

	<style>
		.red {
			color: red;
		}
	</style>

	<fo:loadAssets>
		<script>
			$(document).ready(function() {
				$('#characterLeft').text('{f:translate(key:"contact.limit.total.characters")}');
				$('#message').keydown(function() {
					var max = 140;
					var len = $(this).val().length;
					if (len >= max) {
						$('#characterLeft').text('{f:translate(key:"contact.limit.met")}');
						$('#characterLeft').addClass('red');
						$('#btnSubmit').addClass('disabled');
					}
					else {
						var numberOfCharacters = max - len;
						$('#characterLeft').text(numberOfCharacters + ' {f:translate(key:"contact.limit.characters")}');
						$('#btnSubmit').removeClass('disabled');
						$('#characterLeft').removeClass('red');
					}
				});
			});
		</script>
	</fo:loadAssets>

	<f:render section="FormError" partial="Form/Error" arguments="{_all}"/>

	<div class="form-area">
		<f:form action="submit" controller="Form" additionalAttributes="{role: 'form'}" method="post">
			<br style="clear:both">
			<h3>
				<f:translate key="contact.form"/>
			</h3>
			<div class="form-group">
				<input type="text"
				       class="form-control"
				       id="name"
				       name="name"
				       value="{values.name}"
				       placeholder="{f:translate(key:'name')}"
				       required="required"/>
			</div>
			<div class="form-group">
				<input type="text"
				       class="form-control"
				       id="email"
				       name="email"
				       value="{values.email}"
				       placeholder="{f:translate(key:'email')}"
				       required="required"/>
			</div>
			<div class="form-group">
				<input type="text"
				       class="form-control"
				       id="subject"
				       name="subject"
				       value="{values.subject}"
				       placeholder="{f:translate(key:'subject')}"
				       required="required"/>
			</div>
			<div class="form-group">
						<textarea class="form-control"
						          id="message"
						          name="message"
						          placeholder="{f:translate(key:'message')}"
						          maxlength="140"
						          rows="7">{values.message}</textarea>
				<p id="characterLeft" class="help-block">
					<f:translate key="contact.limit"/>
				</p>
			</div>

			<!-- Only mandatory field -->
			<f:form.hidden name="values" value="{contentElement.uid}"/>
			<input type="submit" value="{f:translate(key:'submit')}" class="btn btn-primary pull-right">

			<fo:honeyPot/>
			<fo:message.development/>
		</f:form>
	</div>

</f:section>

<f:section name="feedback">
	<p>
		Dear {name},
	</p>

	<p>
		We have received your request via the contact form on www.example.org. We will process your request and get in contact with you soon.
	</p>

	<formule:form.show labelsIn="formule"/>
	{namespace formule=Fab\Formule\ViewHelpers}
</f:section>
</html>
